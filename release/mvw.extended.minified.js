console.log("https://github.com/DataDink/mvw extended v1.2.0");
(() => {(()=>{let e=(function(){return this}()).MemberQuery=class MemberQuery{#e;#t=[];#r=[];#i="";constructor(t,r=e.Config.Default){this.#e=r;var i=String.scanWhile(t,r.trimCharacters),n=String.scanUntil(t,r.pathTerms,i);this.#t=t.substring(i,-1===n?t.length:n).split(r.memberDelimiter),this.#i=this.#t.pop(),-1!==(i=String.scanWhile(t,r.pathTerms,n))&&(n=String.scanUntil(t,r.selectorTerminator,i),this.#r=t.substring(i,-1===n?t.length:n).split(r.parameterDelimiter).map((e=>e.trim().split(r.memberDelimiter))))}get(t){if(null!=(t=e.walk(t,this.#t))){var r,i=t[this.#i];return"function"!=typeof i?i:this.#r.length?(r=this.#r,function(){return i.apply(t,r.map((t=>e.walk(this,t))))}):i.bind(t)}}set(t,r){null!=(t=e.walk(t,this.#t))&&(t[this.#i]=r)}static walk(e,t){for(var r=0;null!=e&&r<t.length;r++)e=e[t[r]];return e}static Config=class{static#n;static get Default(){return e.Config.#n||(e.Config.#n=new MemberQuery.Config)}memberDelimiter=".";selectorDelimiter="(";parameterDelimiter=",";selectorTerminator=")";trimCharacters=" \t";constructor(e=null){Object.override(this,e),this.pathTerms=this.selectorDelimiter+this.trimCharacters+this.selectorTerminator,Object.freeze(this)}}}})(),Node.Scope=class Scope{static#s=Symbol("mapping-scope");attributePrefix="data-";attributeDelimiter="-";constructor(e={}){this.overrides=Object.assign({},e||{}),this.queryConfig=new MemberQuery.Config(this.overrides),Object.override(this,this.overrides),Object.freeze(this),Object.freeze(this.overrides)}static create(e,t=null){return e[Scope.#s]=new Scope(t)}static continue(e,t=null){return e[Scope.#s]||(e[Scope.#s]=e.parentNode&&e.parentNode[Scope.#s])}},(()=>{const e=Symbol("cached-queries");let t=Node.prototype.map=function(e,r=null){var i=Node.Scope.continue(this)||Node.Scope.create(this,r);return t.mapNode(this,e,i)};t.mapNode=function(r,i,n){if(n!==Node.Scope.continue(r))return r;var s=r[e]||(r[e]=[]);return Array.from(r.attributes||[]).forEach((e=>{if(0===e.name.indexOf(n.attributePrefix)){var o=e.name.toLowerCase().trim(),a=s[o]||(s[o]=new MemberQuery(t.repath(r,o,n),n.queryConfig)),c=e.value.trim(),u=s[c]||(s[c]=new MemberQuery(c,n.queryConfig)),l=a.get(r),h=u.get(i);("object"==typeof h||l!==h)&&a.set(r,h)}})),Array.from(r.childNodes).forEach((e=>t.mapNode(e,i,n))),r},t.repath=function(e,t,r){return t.substr(r.attributePrefix.length).split(r.attributeDelimiter).map((t=>{if(null!=e&&!(t in e)){var r=t.toLowerCase();for(var i in e)if(r===i.toLowerCase()){t=i;break}}return e=null==e?null:e[t],t})).join(r.queryConfig.memberDelimiter)}})(),Object.override=function(e,t){if(t&&e)for(var r in e)r in t&&(e[r]=t[r]);return e},(()=>{function e(e,t,r,i){if(r<0)return-1;if(i)for(;r<e.length&&-1===t.indexOf(e[r]);)r++;else for(;r<e.length&&-1!==t.indexOf(e[r]);)r++;return r>=e.length?-1:r}String.scanUntil=(t,r,i=0)=>e(t,r,i,!0),String.scanWhile=(t,r,i=0)=>e(t,r,i,!1)})(),(()=>{let e=Symbol("attribute");Object.defineProperty(Element.prototype,"attribute",{configurable:!1,enumerable:!0,get:function(){return this[e]||(this[e]=(t=this,new Proxy({},{has:(e,r)=>t.hasAttribute(r),get:(e,r)=>!!t.hasAttribute(r)&&t.getAttribute(r),set:(e,r,i)=>!1!==i?t.setAttribute(r,!0===i?r:null==i?"":i)||!0:t.removeAttribute(r)||!0,ownKeys:()=>Array.from(t.attributes).map((e=>e.name))})));var t}})})(),(()=>{let e=Symbol("class");Object.defineProperty(Element.prototype,"class",{configurable:!1,enumerable:!0,get:function(){return this[e]||(this[e]=(t=this,new Proxy({},{has:(e,r)=>t.classList.contains(r),get:(e,r)=>t.classList.contains(r),set:(e,r,i)=>t.classList.remove(r)||!!i&&t.classList.add(r)||!0,ownKeys:()=>Array.from(t.classList)})));var t}})})(),Object.defineProperty(HTMLElement.prototype,"shown",{configurable:!1,enumerable:!0,get:function(){return!this.hidden},set:function(e){this.hidden=!e}}),(()=>{const e=Symbol("template-content"),t=Symbol("template-data");Object.defineProperty(HTMLTemplateElement.prototype,"template",{configurable:!1,enumerable:!1,get:function(){return this[t]},set:function(r){this[t]=r;for(var i=this[e]??(this[e]=[]),n=(Node.Scope.continue(this)||{}).overrides,s=(null==r?[]:"object"==typeof r&&Symbol.iterator in r?Array.from(r):[r]),o=0;o<s.length&&o<i.length;o++)i[o].forEach((e=>e.map(s[o])));for(;i.length>s.length;)i.pop().forEach((e=>e.parentNode&&e.parentNode.removeChild(e)));for(o=i.length;o<s.length;o++){var a=i[i.length-1],c=(a?a[a.length-1]:this).nextSibling,u=Array.from(this.content.cloneNode(!0).map(s[o],n).childNodes);i.push(u),u.forEach((e=>this.parentNode.insertBefore(e,c)))}}})})(),(()=>{let e=Symbol("autosize");function t(){this.style.width=0,this.style.width=this.scrollWidth+"px"}Object.defineProperty(HTMLInputElement.prototype,"autosize",{configurable:!1,enumerable:!0,get:function(){return this[e]||!1},set:function(r){return this[e]=!1!==r,this.removeEventListener("input",t),this.removeEventListener("focus",t),!1===r||(this.addEventListener("input",t),this.addEventListener("focus",t),setTimeout(t.bind(this))),!0}})})(),(()=>{let e=Object.deserialize=function(t,r=null){return r=new e.Config(t,r),e.parse(r)};e.parse=function(t){t.trim();var r=t.source[t.index];return"["===r?e.array(t):"{"===r?e.object(t):'"'===r||"'"===r?e.string(t):e.constant(t)},e.array=function(t){var r=[];for(t.index++,t.catalog.push(r),t.trim();t.index<t.source.length&&"]"!==t.source[t.index];)r.push(e.parse(t)),t.delim();return t.index++,r},e.object=function(t){if(t.index++,t.trim(),"}"===t.source[t.index])return{};for(var r=e.initializer(t);t.index<t.source.length&&"}"!==t.source[t.index];){var i=e.key(t),n=e.parse(t);r[i]=n,t.delim()}return t.index++,r},e.initializer=function(t){var r=null,i=e.key(t);return i===t.refKey?r=t.catalog[e.parse(t)]:i===t.typeKey?t.catalog.push(r=t.parseType(e.parse(t))):(t.catalog.push(r={}),r[i]=e.parse(t)),t.delim(),r},e.key=function(t){var r=e.string(t);return t.delim(),r},e.string=function(e){for(var t=e.source[e.index],r=e.index++;e.index<e.source.length&&e.source[e.index]!==t;)"\\"===e.source[e.index++]&&e.index++;var i=e.source.substring(r,++e.index);return JSON.parse(i)},e.constant=function(e){var t=e.index;return e.index=String.scanUntil(e.source," \t\r\n,]}",t),e.index=-1===e.index?e.source.length:e.index,JSON.parse(e.source.substring(t,e.index))},e.Config=class Config{refKey="*";typeKey=":";whitespace=" \t\r\n";parseType=function e(t){if(!/^[0-9a-z@$#\.]+$/i.test(t))return{};try{return new(eval(t))}catch{return{}}};constructor(e,t=null){Object.override(this,t),this.source=e,this.index=0,this.catalog=[],this.delimspace=",:"+this.whitespace,this.trim=()=>(this.index=String.scanWhile(this.source,this.whitespace,this.index),-1===this.index?this.index=this.source.length:this.index),this.delim=()=>(this.index=String.scanWhile(this.source,this.delimspace,this.index),-1===this.index?this.index=this.source.length:this.index)}}})(),(()=>{let e=Object.serialize=function(t,r=null){return r=new e.Config(r),e.format(t,r)};e.format=function(t,r){if("function"==typeof t)return JSON.stringify(r.formatFunction(t));if(!(t instanceof Object))return JSON.stringify(t);var i=r.catalog.indexOf(t);if(i>=0)return`{${e.member(r.refKey,i,r)}}`;r.catalog.push(t);var n=Array.isArray(t),s=n?"]":"}";return`${n?"[":"{"}${(n?t.map((t=>e.format(t,r))):[e.member(r.typeKey,r.formatType(t),r)].concat(Array.from(e.fields(t)).map((i=>e.member(i,t[i],r))))).join(",")}${s}`},e.fields=function*(e){for(var t in e)null!=e[t]&&"function"!=typeof e[t]&&(yield t)},e.member=function(t,r,i){return`${JSON.stringify((t||"").toString())}:${e.format(r,i)}`},e.Config=class{refKey="*";typeKey=":";formatType=function(e){return e.constructor.name};formatFunction=function(e){return`function ${e.name}() {}`};constructor(e){Object.override(this,e),this.catalog=[]}}})(),Promise.queue=function(e,t=null){var r=e(t);return r instanceof Promise?r.then((t=>Promise.queue(e,t))):Promise.resolve(r)};})();